FROM node:18-alpine

ARG NODE_ENV
ARG PORT
ARG MONGODB_URI
ARG HOST_EMAIL_ADDRESS
ARG HOST_EMAIL_PASSWORD


ENV NODE_ENV=${NODE_ENV}
ENV PORT=${PORT}
ENV MONGODB_URI=${MONGODB_URI}
ENV HOST_EMAIL_ADDRESS=${HOST_EMAIL_ADDRESS}
ENV HOST_EMAIL_PASSWORD=${HOST_EMAIL_PASSWORD}


WORKDIR /app

COPY package.json .

RUN npm install

COPY . .

EXPOSE 4000

# Build the backend
RUN npm run build

CMD ["npm", "run", "start"]
